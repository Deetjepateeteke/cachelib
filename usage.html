<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="API Reference" href="reference.html" /><link rel="prev" title="Installation" href="installation.html" />
        <link rel="canonical" href="https://deetjepateeteke.github.io/cachelib/usage.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.07.19 -->
        <title>Usage Guide - cachelib 0.5.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=25af2a20" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">cachelib 0.5.2 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <span class="sidebar-brand-text">cachelib 0.5.2 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Usage Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">API Reference</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/usage.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="usage-guide">
<h1>Usage Guide<a class="headerlink" href="#usage-guide" title="Link to this heading">¶</a></h1>
<p>This guide shows how to use <strong>cachelib</strong>.</p>
<p>Caching is a technique where the result of expensive computations or functions that take a while (eg. loading webpages) get stored so they can easily be retrieved later without having to compute them again.</p>
<hr class="docutils" />
<section id="quickstart">
<h2>Quickstart<a class="headerlink" href="#quickstart" title="Link to this heading">¶</a></h2>
<p>Here is a basic usage example of how to use <code class="docutils literal notranslate"><span class="pre">cachelib</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cachelib</span>

<span class="c1"># Create an in-memory cache</span>
<span class="n">cache</span> <span class="o">=</span> <span class="n">cachelib</span><span class="o">.</span><span class="n">MemoryCache</span><span class="p">()</span>

<span class="c1"># Set a value with an optional TTL (in seconds)</span>
<span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Retrieve a cached value</span>
<span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span>  <span class="c1"># -&gt; returns &#39;bar&#39;</span>

<span class="c1"># Check if a key exists</span>
<span class="k">if</span> <span class="s2">&quot;foo&quot;</span> <span class="ow">in</span> <span class="n">cache</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;foo&#39; is cached&quot;</span><span class="p">)</span>

<span class="c1"># Delete a cached value</span>
<span class="n">cache</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span>

<span class="c1"># Clear the entire cache</span>
<span class="n">cache</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="cache-expiration-ttl">
<h2>Cache Expiration (TTL)<a class="headerlink" href="#cache-expiration-ttl" title="Link to this heading">¶</a></h2>
<p>In cachelib, every cache has its own cleanup thread, that evicts expired keys automatically.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cache</span> <span class="o">=</span> <span class="n">MemoryCache</span><span class="p">(</span><span class="n">ttl</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>

<span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In the above example, the cache is assigned a <strong>global TTL (Time To Live)</strong>. This means that every key/value pair in the cache will expire in 60 seconds after creation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cache</span> <span class="o">=</span> <span class="n">MemoryCache</span><span class="p">()</span>

<span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>  <span class="c1"># Will expire</span>
<span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;foo2&quot;</span><span class="p">,</span> <span class="s2">&quot;bar2&quot;</span><span class="p">)</span>  <span class="c1"># Won&#39;t expire</span>

</pre></div>
</div>
<p>Here, instead of assigning a global TTL, the first item has been given a TTL, while the second uses the global TTL. Since the global TTL defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>, meaning an unlimited time to live, the second item won’t expire.</p>
</section>
<section id="max-size-and-max-memory">
<h2>Max-size and max-memory<a class="headerlink" href="#max-size-and-max-memory" title="Link to this heading">¶</a></h2>
<p><strong>Max-size</strong> and <strong>max-memory</strong> are arguments that control the capacity of the cache. Once one of those gets exceeded, occupied space needs to be freed up by evicting items in the cache.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># To create a cache with a max-size of 5</span>
<span class="n">cache</span> <span class="o">=</span> <span class="n">cachelib</span><span class="o">.</span><span class="n">MemoryCache</span><span class="p">(</span><span class="n">max_size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>This creates a cache that can hold 5 key/value pairs.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># To create a cache with a max-memory of 256mb</span>
<span class="n">cache</span> <span class="o">=</span> <span class="n">cachelib</span><span class="o">.</span><span class="n">MemoryCache</span><span class="p">(</span><span class="n">max_memory</span><span class="o">=</span><span class="s2">&quot;256mb&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This creates a cache that can hold up to 256mb of data.</p>
<p>When using max_memory, the supported units are: b, kb, mb, gb, tb. Or you can just assign it an integer value to let it default to bytes.</p>
</section>
<section id="eviction-policies">
<h2>Eviction Policies<a class="headerlink" href="#eviction-policies" title="Link to this heading">¶</a></h2>
<p>When the <strong>max-size</strong> of a cache gets exceeded, space needs to be freed up for other items to get added to the cache. This is where eviction policies come in.</p>
<section id="lru-least-recently-used">
<h3>LRU (Least Recently Used)<a class="headerlink" href="#lru-least-recently-used" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cachelib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cachelib.eviction</span><span class="w"> </span><span class="kn">import</span> <span class="n">LRU</span>

<span class="n">cache</span> <span class="o">=</span> <span class="n">cachelib</span><span class="o">.</span><span class="n">MemoryCache</span><span class="p">(</span><span class="n">max_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">eviction_policy</span><span class="o">=</span><span class="n">LRU</span><span class="p">)</span>

</pre></div>
</div>
<p>In the example above, <strong>LRU (Least Recently Used)</strong> is set as the eviction policy. When the cache’s max-size gets exceeded, the least recently used item will get evicted from the cache.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Least Recently Used</span>

<span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>

<span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># Max-size gets exceeded, so evict LRU</span>

<span class="k">assert</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cache</span>
</pre></div>
</div>
<p>In this example, you can see that when <code class="docutils literal notranslate"><span class="pre">cache.get(&quot;a&quot;)</span></code> is called, “b” becomes the least recently accessed. And when “c” is added to the cache, the cache’s max-size gets exceeded and “b” gets evicted from the cache.</p>
</section>
<section id="lfu-least-frequently-used">
<h3>LFU (Least Frequently Used)<a class="headerlink" href="#lfu-least-frequently-used" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cachelib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cachelib.eviction</span><span class="w"> </span><span class="kn">import</span> <span class="n">LFU</span>

<span class="n">cache</span> <span class="o">=</span> <span class="n">cachelib</span><span class="o">.</span><span class="n">MemoryCache</span><span class="p">(</span><span class="n">max_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">eviction_policy</span><span class="o">=</span><span class="n">LFU</span><span class="p">)</span>

</pre></div>
</div>
<p>Here, <strong>LFU (Least Frequently Used)</strong> is set as the eviction policy. When the cache’s max-size gets exceeded, the least frequently used item will get evicted from the cache.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Least Frequently Used</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>

<span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># Max-size gets exceeded, so evict LFU</span>

<span class="k">assert</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cache</span>
</pre></div>
</div>
<p>In this example, <code class="docutils literal notranslate"><span class="pre">cache.get(&quot;a&quot;)</span></code> is called 5 times, which makes it the most frequently accessed. When “c” is added to the cache, the max-size gets exceeded and “b” gets evicted.</p>
<blockquote>
<div><p>[!INFO] Items equally accessed
When there are two items accessed an equal amount of times, the item to evict will be decided by LRU based eviction.</p>
</div></blockquote>
</section>
<section id="fifo-first-in-first-out">
<h3>FIFO (First In, First Out)<a class="headerlink" href="#fifo-first-in-first-out" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cachelib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cachelib.eviction</span><span class="w"> </span><span class="kn">import</span> <span class="n">FIFO</span>

<span class="n">cache</span> <span class="o">=</span> <span class="n">MemoryCache</span><span class="p">(</span><span class="n">max_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">eviction_policy</span><span class="o">=</span><span class="n">FIFO</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, <strong>FIFO (First In, First Out)</strong> is used as the eviction policy. When the cache’s max-size gets exceeded, the item that got added first gets deleted.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># First added</span>
<span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="k">assert</span> <span class="s2">&quot;a&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cache</span>
</pre></div>
</div>
<p>In this example, “a” got added first to the cache and thus it will be the first item to get evicted.</p>
</section>
</section>
<section id="cache-backends">
<h2>Cache backends<a class="headerlink" href="#cache-backends" title="Link to this heading">¶</a></h2>
<p>A cache backend is the way the items in the cache are stored. This can be <strong>on disk</strong> or in <strong>memory</strong>. The implementations for these two options are <code class="docutils literal notranslate"><span class="pre">cachelib.DiskCache</span></code> and <code class="docutils literal notranslate"><span class="pre">cachelib.MemoryCache</span></code>.</p>
<section id="diskcache">
<h3>DiskCache<a class="headerlink" href="#diskcache" title="Link to this heading">¶</a></h3>
<p>DiskCache needs a <code class="docutils literal notranslate"><span class="pre">path</span></code> argument. This is the path to the file where the cache will be stored. It takes as input a <code class="docutils literal notranslate"><span class="pre">str</span></code> or a <code class="docutils literal notranslate"><span class="pre">pathlib.Path</span></code> object.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cachelib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cachelib.eviction</span><span class="w"> </span><span class="kn">import</span> <span class="n">LRU</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="n">PATH</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;example.db&quot;</span><span class="p">)</span>

<span class="n">cache</span> <span class="o">=</span> <span class="n">cachelib</span><span class="o">.</span><span class="n">DiskCache</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">PATH</span><span class="p">,</span> <span class="n">max_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">eviction_policy</span><span class="o">=</span><span class="n">LRU</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="memorycache">
<h3>MemoryCache<a class="headerlink" href="#memorycache" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cachelib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cachelib.eviction</span><span class="w"> </span><span class="kn">import</span> <span class="n">LRU</span>

<span class="n">cache</span> <span class="o">=</span> <span class="n">cachelib</span><span class="o">.</span><span class="n">MemoryCache</span><span class="p">(</span><span class="n">max_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">eviction_policy</span><span class="o">=</span><span class="n">LFU</span><span class="p">)</span>
</pre></div>
</div>
<p>Since MemoryCache is an in memory cache, the cache won’t be saved when the program gets exited. Therefore you can save the cache to a <code class="docutils literal notranslate"><span class="pre">.pkl</span></code> file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cachelib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cachelib.eviction</span><span class="w"> </span><span class="kn">import</span> <span class="n">LRU</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="n">PATH</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;example.pkl&quot;</span><span class="p">)</span>

<span class="n">cache</span> <span class="o">=</span> <span class="n">cachelib</span><span class="o">.</span><span class="n">MemoryCache</span><span class="p">(</span><span class="n">max_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">eviction_policy</span><span class="o">=</span><span class="n">LFU</span><span class="p">)</span>
<span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">)</span>

<span class="c1"># Save the cache as a .pkl file</span>
<span class="n">cache</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">PATH</span><span class="p">)</span>

<span class="c1"># Load a cache from a .pkl file</span>
<span class="n">loaded_cache</span> <span class="o">=</span> <span class="n">cachelib</span><span class="o">.</span><span class="n">MemoryCache</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">PATH</span><span class="p">)</span>

<span class="c1"># Check if &quot;foo&quot; (set in the cache before saving) is in the loaded cache</span>
<span class="k">assert</span> <span class="s2">&quot;foo&quot;</span> <span class="ow">in</span> <span class="n">loaded_cache</span>
</pre></div>
</div>
</section>
</section>
<section id="multi-level-cache">
<h2>Multi-level cache<a class="headerlink" href="#multi-level-cache" title="Link to this heading">¶</a></h2>
<p>A multi-level cache is a cache that exists out of multiple caches. Instead of having one huge cache, the cache is divided into multiple smaller caches. This improves the performance when retrieving cached items.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">cachelib</span><span class="w"> </span><span class="kn">import</span> <span class="n">DiskCache</span><span class="p">,</span> <span class="n">MemoryCache</span><span class="p">,</span> <span class="n">MultiLevelCache</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cachelib.eviction</span><span class="w"> </span><span class="kn">import</span> <span class="n">LRU</span><span class="p">,</span> <span class="n">LFU</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="n">PATH</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;example.db&quot;</span><span class="p">)</span>

<span class="n">cache</span> <span class="o">=</span> <span class="n">MultiLevelCache</span><span class="p">(</span>
    <span class="n">levels</span><span class="o">=</span><span class="p">[</span>
        <span class="n">MemoryCache</span><span class="p">(</span><span class="n">max_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">eviction_policy</span><span class="o">=</span><span class="n">LFU</span><span class="p">),</span>
        <span class="n">MemoryCache</span><span class="p">(</span><span class="n">max_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">eviction_policy</span><span class="o">=</span><span class="n">LFU</span><span class="p">),</span>
        <span class="n">DiskCache</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">PATH</span><span class="p">,</span> <span class="n">max_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">eviction_policy</span><span class="o">=</span><span class="n">LRU</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="n">inclusivity</span><span class="o">=</span><span class="s2">&quot;inclusive&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This creates a multi-level cache existing of two MemoryCaches and one DiskCache. When the first cache is full, the evicted items will be transferred to the second cache and if that one is also full, the evicted items will be transferred to the DiskCache before getting removed for good.</p>
<p><code class="docutils literal notranslate"><span class="pre">Inclusivity</span></code> can either be <strong>“inclusive”</strong> or <strong>“exclusive”</strong>:
- <strong>“inclusive”</strong>: when an item gets added to the cache, it gets added to every cache in the multi-level cache.
- <strong>“exclusive”</strong>: when an item gets added to the cache, it only gets added to the first cache.</p>
<p>The different caches in a multi-level cache are defined as <code class="docutils literal notranslate"><span class="pre">cache.l1</span></code>, <code class="docutils literal notranslate"><span class="pre">cache.l2</span></code> and <code class="docutils literal notranslate"><span class="pre">cache.l3</span></code>. Whenever <code class="docutils literal notranslate"><span class="pre">cache.get(key)</span></code> is called, the cache tries to find the key in its L1 cache first. If it isn’t found there, it looks for it in its L2 cache and then its L3 cache.</p>
<p>When a key is accessed, the key gets moved to the L1 cache. This is the reason why a multi-level cache helps to improve performance, since the frequently accessed keys and recently added keys are stored in the L1 cache, where will be looked first when trying to retrieve a key.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="reference.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">API Reference</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="installation.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Installation</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Deetjepateeteke &lt;https://github.com/Deetjepateeteke&gt;
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Usage Guide</a><ul>
<li><a class="reference internal" href="#quickstart">Quickstart</a></li>
<li><a class="reference internal" href="#cache-expiration-ttl">Cache Expiration (TTL)</a></li>
<li><a class="reference internal" href="#max-size-and-max-memory">Max-size and max-memory</a></li>
<li><a class="reference internal" href="#eviction-policies">Eviction Policies</a><ul>
<li><a class="reference internal" href="#lru-least-recently-used">LRU (Least Recently Used)</a></li>
<li><a class="reference internal" href="#lfu-least-frequently-used">LFU (Least Frequently Used)</a></li>
<li><a class="reference internal" href="#fifo-first-in-first-out">FIFO (First In, First Out)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cache-backends">Cache backends</a><ul>
<li><a class="reference internal" href="#diskcache">DiskCache</a></li>
<li><a class="reference internal" href="#memorycache">MemoryCache</a></li>
</ul>
</li>
<li><a class="reference internal" href="#multi-level-cache">Multi-level cache</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=8e576371"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>